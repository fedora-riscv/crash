From 6c5f0c6ff5d158f2ef4fa997a052b0643d0c25ee Mon Sep 17 00:00:00 2001
From: Alexey Makhalov <amakhalov@vmware.com>
Date: Fri, 19 Mar 2021 21:07:36 -0700
Subject: [PATCH 19/27] vmware_guestdump: add debugging of the init function

Dump memory and registers state after parsing.

Signed-off-by: Alexey Makhalov <amakhalov@vmware.com>
---
 vmware_guestdump.c | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/vmware_guestdump.c b/vmware_guestdump.c
index 62da0a77a227..cf818e588a60 100644
--- a/vmware_guestdump.c
+++ b/vmware_guestdump.c
@@ -267,6 +267,11 @@ vmware_guestdump_init(char *filename, FILE *ofp)
 	fseek(vmss.dfp, 0L, SEEK_SET);
 	fprintf(ofp, LOGPRX"vmem file: %s\n\n", vmem_filename);
 
+	if (CRASHDEBUG(1)) {
+                vmware_guestdump_memory_dump(ofp);
+                dump_registers_for_vmss_dump();
+        }
+
 exit:
 	if (fp)
 		fclose(fp);
-- 
2.30.2

